<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Bot C√≥digo de Aposta</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="container">
    <h1>üé∞ BOT DE APOSTA</h1>

    <p class="tempo">‚è≥ Tempo restante: {{ tempo }}</p>

    <!-- STATUS -->
    <div class="status" id="status">ü§î ANALISANDO OS RESULTADOS...</div>
    <div id="signal" class="signal"></div>

    <!-- BOTOES DE RESULTADOS -->
    <div class="controls">
        <button onclick="addResult('P')">PLAYER</button>
        <button onclick="addResult('B')">BANKER</button>
        <button onclick="addResult('T')">EMPATE</button>
    </div>

    <h2>üìú Hist√≥rico</h2>
    <div class="historico">
        <ul id="historyList">
            {% for item in historico %}
                <li>{{ item.tipo }} - <small>{{ item.hora }}</small></li>
            {% endfor %}
        </ul>
    </div>
</div>

<script>
let history = [];

// Adiciona resultado manual
function addResult(r) {
    history.push(r);

    // Atualiza hist√≥rico visual
    const list = document.getElementById("historyList");
    const item = document.createElement("li");
    item.textContent = new Date().toLocaleTimeString() + " ‚Üí " + r;
    list.prepend(item);

    // Recalcula probabilidade sempre que houver novo resultado
    analyzeProbabilities();
}

// Fun√ß√£o de an√°lise probabil√≠stica
function analyzeProbabilities() {
    const status = document.getElementById("status");
    const signal = document.getElementById("signal");

    if(history.length === 0){
        status.className = "status yellow";
        status.innerHTML = "ü§î ANALISANDO OS RESULTADOS...";
        signal.innerHTML = "";
        return;
    }

    // Conta ocorr√™ncias
    let countP = history.filter(x => x === "P").length;
    let countB = history.filter(x => x === "B").length;
    let countT = history.filter(x => x === "T").length;
    let total = countP + countB + countT;

    // Calcula probabilidades
    let probP = ((countP / total) * 100).toFixed(1);
    let probB = ((countB / total) * 100).toFixed(1);
    let probT = ((countT / total) * 100).toFixed(1);

    // Determina sinal sugerido
    let maxProb = Math.max(probP, probB, probT);
    let suggested = "";
    if(maxProb == probP) suggested = "PLAYER";
    else if(maxProb == probB) suggested = "BANKER";
    else suggested = "EMPATE";

    // Atualiza status visual
    status.className = "status green";
    status.innerHTML = `üí° SINAL SUGERIDO: ${suggested}`;

    // Mostra probabilidades detalhadas
    signal.innerHTML = `
        üü¢ PLAYER: ${probP}% <br>
        üî¥ BANKER: ${probB}% <br>
        üü° EMPATE: ${probT}%
    `;
}
</script>

</body>
</html>
