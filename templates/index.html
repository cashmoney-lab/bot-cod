<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Bot Baccarat</title>
<link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="card">
<h2>Bem-vindo, {{ user }}</h2>

<p><strong>HistÃ³rico:</strong></p>
<div id="history"></div>

<button onclick="addResult('B')">BANKER</button>
<button onclick="addResult('P')">PLAYER</button>
<button onclick="addResult('T')">EMPATE</button>

<hr>
<h3 id="signal">Aguardando dados...</h3>
<p id="confidence"></p>

<a href="/logout">Sair</a>
</div>

<script>
let history = [];
const MAX_HISTORY = 20;

function addResult(r) {
    history.push(r);
    if (history.length > MAX_HISTORY) {
        history.shift();
    }
    document.getElementById("history").innerText = history.join(" ");
    analyze();
}

function analyze() {
    const len = history.length;

    // ðŸ‘‰ sÃ³ mostra sinal a cada 3 OU 6 entradas
    if (!(len % 3 === 0 || len % 6 === 0)) {
        document.getElementById("signal").innerText =
            "â³ Aguardando mais dados...";
        document.getElementById("confidence").innerText = "";
        return;
    }

    let B = history.filter(x => x === "B").length;
    let P = history.filter(x => x === "P").length;
    let T = history.filter(x => x === "T").length;

    let total = history.length;

    let bPerc = (B / total) * 100;
    let pPerc = (P / total) * 100;
    let tPerc = (T / total) * 100;

    let signal = "âŒ NÃƒO APOSTAR";
    let conf = Math.max(bPerc, pPerc);

    if (bPerc > 50) signal = "ðŸŸ¢ APOSTAR BANKER + EMPATE";
    else if (pPerc > 50) signal = "ðŸŸ¢ APOSTAR PLAYER + EMPATE";

    document.getElementById("signal").innerText = signal;
    document.getElementById("confidence").innerText =
        `ConfianÃ§a: ${conf.toFixed(1)}% | Banker ${bPerc.toFixed(1)}% | Player ${pPerc.toFixed(1)}% | Tie ${tPerc.toFixed(1)}%`;
}
</script>

</body>
</html>
